# SessionStartã¨UserPromptSubmitã®å®Ÿç”¨çš„ãªè¨­å®šä¾‹

# ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã®è‡ªå‹•è¨­å®š
SessionStart:
  # æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ†æã‚’å®Ÿè¡Œ
  - matcher: startup
    actions:
      - type: command
        command: "bash examples/project_analyzer.sh '{.session_id}'"

  # ã‚»ãƒƒã‚·ãƒ§ãƒ³å†é–‹æ™‚ã«ã¯ç°¡å˜ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿
  - matcher: resume
    actions:
      - type: output
        message: "ğŸ“Œ ã‚»ãƒƒã‚·ãƒ§ãƒ³å†é–‹: {.session_id} (ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: {.cwd})"

  # /clearã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚
  - matcher: clear
    actions:
      - type: output
        message: "ğŸ—‘ï¸ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ"

# ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®æ¤œè¨¼ã¨ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹
UserPromptSubmit:
  # ç§˜å¯†æƒ…å ±ã®èª¤é€ä¿¡ã‚’é˜²ã
  - conditions:
      - type: prompt_contains
        value: "api_key"
    actions:
      - type: output
        message: "âš ï¸ APIã‚­ãƒ¼ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ç’°å¢ƒå¤‰æ•°ã®ä½¿ç”¨ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚"
        exit_status: 2  # ãƒ–ãƒ­ãƒƒã‚¯

  - conditions:
      - type: prompt_contains
        value: "password"
    actions:
      - type: output
        message: "âš ï¸ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚é€ä¿¡ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã—ãŸã€‚"
        exit_status: 2  # ãƒ–ãƒ­ãƒƒã‚¯

  # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
  - conditions:
      - type: prompt_starts_with
        value: "DEBUG:"
    actions:
      - type: command
        command: "echo '[DEBUG MODE] ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: {.prompt}' >> debug.log"
      - type: output
        message: "ğŸ› ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒdebug.logã«è¨˜éŒ²ã•ã‚Œã¾ã—ãŸ"

# ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ã®æœ€é©åŒ–
PreToolUse:
  # Goãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†æ™‚ã«Serena MCPã®ä½¿ç”¨ã‚’ä¿ƒã™
  - matcher: "Edit|Write"
    conditions:
      - type: file_extension
        value: ".go"
    actions:
      - type: output
        message: |
          ğŸ’¡ ãƒ’ãƒ³ãƒˆ: Goãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†ã«ã¯MCP Serenaã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™
          â€¢ mcp__serena__replace_symbol_body: é–¢æ•°/ãƒ¡ã‚½ãƒƒãƒ‰ã®æœ¬ä½“ã‚’ç½®æ›
          â€¢ mcp__serena__find_symbol: ã‚·ãƒ³ãƒœãƒ«ã®å®šç¾©ã‚’æ¤œç´¢
          â€¢ ã‚ˆã‚Šç²¾å¯†ãªã‚³ãƒ¼ãƒ‰ç·¨é›†ãŒå¯èƒ½ã§ã™

  # TypeScript/JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†æ™‚ã‚‚åŒæ§˜
  - matcher: "Edit|Write"
    conditions:
      - type: file_extension
        value: ".ts"
    actions:
      - type: output
        message: "ğŸ’¡ ãƒ’ãƒ³ãƒˆ: TypeScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚‚MCP Serenaã§ã‚·ãƒ³ãƒœãƒ«å˜ä½ã®ç·¨é›†ãŒå¯èƒ½ã§ã™"

  # Pythonãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†æ™‚
  - matcher: "Edit|Write"
    conditions:
      - type: file_extension
        value: ".py"
    actions:
      - type: output
        message: "ğŸ’¡ ãƒ’ãƒ³ãƒˆ: Pythonãƒ•ã‚¡ã‚¤ãƒ«ã‚‚MCP Serenaã§é–¢æ•°/ã‚¯ãƒ©ã‚¹å˜ä½ã®ç·¨é›†ãŒå¯èƒ½ã§ã™"

  # å±é™ºãªã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã‚’è­¦å‘Š
  - matcher: "Bash"
    conditions:
      - type: command_contains
        value: "rm -rf"
    actions:
      - type: output
        message: "âš ï¸ å±é™º: 'rm -rf'ã‚³ãƒãƒ³ãƒ‰ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚å®Ÿè¡Œã‚’ç¶šã‘ã¾ã™ã‹ï¼Ÿ"
        exit_status: 0  # è­¦å‘Šã®ã¿ã€ãƒ–ãƒ­ãƒƒã‚¯ã¯ã—ãªã„

  # mainãƒ–ãƒ©ãƒ³ãƒã§ã®gitæ“ä½œã‚’è­¦å‘Š
  - matcher: "Bash"
    conditions:
      - type: command_starts_with
        value: "git commit"
    actions:
      - type: command
        command: |
          BRANCH=$(git branch --show-current 2>/dev/null)
          if [ "$BRANCH" = "main" ] || [ "$BRANCH" = "master" ]; then
            echo "âš ï¸ è­¦å‘Š: main/masterãƒ–ãƒ©ãƒ³ãƒã§ã‚³ãƒŸãƒƒãƒˆã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ï¼"
            echo "ğŸ’¡ git worktreeã§ä½œæ¥­ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™"
          fi

# ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œå¾Œã®å‡¦ç†
PostToolUse:
  # ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆ/æ›´æ–°ã•ã‚ŒãŸã‚‰ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’ææ¡ˆ
  - matcher: "Write|Edit"
    conditions:
      - type: file_extension
        value: "_test.go"
    actions:
      - type: output
        message: "âœ… ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚'go test ./...'ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"

  # package.jsonãŒæ›´æ–°ã•ã‚ŒãŸã‚‰npm installã‚’ææ¡ˆ
  - matcher: "Write|Edit"
    conditions:
      - type: file_extension
        value: "package.json"
    actions:
      - type: output
        message: "ğŸ“¦ package.jsonãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚'npm install'ã®å®Ÿè¡ŒãŒå¿…è¦ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“"

# é€šçŸ¥è¨­å®š
Notification:
  - actions:
      - type: command
        command: "date '+%Y-%m-%d %H:%M:%S' >> ~/.cchook_notifications.log && echo '{.message}' >> ~/.cchook_notifications.log"

# ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚
Stop:
  - actions:
      - type: command
        command: |
          echo "=== ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†: $(date) ===" >> ~/.cchook_session.log
          echo "ã‚»ãƒƒã‚·ãƒ§ãƒ³ID: {.session_id}" >> ~/.cchook_session.log
          git status --short 2>/dev/null >> ~/.cchook_session.log || true
      - type: output
        message: "ğŸ‘‹ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã—ã¾ã—ãŸã€‚å¤‰æ›´å†…å®¹ã¯ ~/.cchook_session.log ã«è¨˜éŒ²ã•ã‚Œã¾ã—ãŸã€‚"

# Subagentçµ‚äº†æ™‚
SubagentStop:
  - actions:
      - type: output
        message: "ğŸ¤– Subagentã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸ"

# ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆå®Ÿè¡Œæ™‚
PreCompact:
  - actions:
      - type: output
        message: "â™»ï¸ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆåŒ–ã—ã¦ã„ã¾ã™... (ãƒˆãƒªã‚¬ãƒ¼: {.trigger})"
